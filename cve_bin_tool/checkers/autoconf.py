# Copyright (C) 2022 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later


"""
CVE checker for autoconf:

reference:
https://www.gnu.org/software/autoconf/
"""
from __future__ import annotations

from cve_bin_tool.checkers import Checker


class AutoconfChecker(Checker):
    CONTAINS_PATTERNS: list[str] = [
        r"# Autoconf <=2.59b set at_top_builddir instead of at_top_build_prefix:",
        r"# FIXME: should be removed in autoconf 3.0.",
        r"# So that the autoconf-generated scripts will always re-execute",
        r"# These variables are no longer used directly by Autoconf, but are AC_SUBSTed",
        r"# These variables are no longer used directly by Autoconf, but are AC_SUBSTed",
        r"# These variables are no longer used directly by Autoconf, but are AC_SUBSTed",
        r"# and are intended to be withdrawn in a future Autoconf release.",
    ]
    FILENAME_PATTERNS: list[str] = [
        r"autoconf",
    ]
    VERSION_PATTERNS: list[str] = [r"autoconf-(\d+\.\d+)"]
    VENDOR_PRODUCT: list[str] = [("autoconf", "autoconf")]
