# Copyright (C) 2023 SCHUTZWERK GmbH
# SPDX-License-Identifier: GPL-3.0-or-later

"""
CVE checker for abook

References:
https://packages.ubuntu.com/focal/abook
"""
from __future__ import annotations

from cve_bin_tool.checkers import Checker


class AbookChecker(Checker):
    CONTAINS_PATTERNS: list[str] = [
        r"# This is a generated file made by abook for the Spruce e-mail client.",
        r"Sorry, the specified file appears not to be a valid abook addressbook",
        r"Terminal is too small. Minimum terminal size for abook is %dx%d",
        r"program=abook(?:(?:\r?\n.*?)*)version=0.6.1",
    ]
    FILENAME_PATTERNS = [
        r"abook",
    ]
    VERSION_PATTERNS = [r"abook-(\d+\.\d+\.\d+)"]
    VENDOR_PRODUCT = [("abook", "abook")]
