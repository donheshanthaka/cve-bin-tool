# Copyright (C) 2022 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later


"""
CVE checker for rhythmbox:

References:
http://www.rhythmbox.org/
"""
from __future__ import annotations

from cve_bin_tool.checkers import Checker


class RhythmboxChecker(Checker):
    CONTAINS_PATTERNS: list[str] = [
        r"Problem occurred without error being set. This is a bug in Rhythmbox or GStreamer.",
        r"Rhythmbox is distributed in the hope that it will be useful,",
        r"The URL '%s' does not appear to be a podcast feed. It may be the wrong URL, or the feed may be broken. Would you like Rhythmbox to attempt to use it anyway?",
        r"The database was created by a later version of Rhythmbox.  This version of Rhythmbox cannot read the database.",
        r"This version of Rhythmbox has been banned.",
        r"along with Rhythmbox; if not, write to the Free Software Foundation, Inc.,",
        r"org.gnome.rhythmbox.plugins.audioscrobbler.service",
        r"unable to create Rhythmbox's user cache dir, %s",
        r"unable to create Rhythmbox's user data dir, %s",
    ]
    FILENAME_PATTERNS = [
        r"rhythmbox",
        r"rhythmbox-client",
        r"librhythmbox-core.so.10.0.0",
        r"libaudiocd.so",
    ]
    VERSION_PATTERNS = [r"rhythmbox-(\d+\.\d+\.\d+)"]
    VENDOR_PRODUCT = [("gnome", "rhythmbox")]
